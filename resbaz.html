<html>
<head>
  <meta charset="utf-8">
  <title>DIT4C &amp; ResBaz 2015</title>
  <link rel="canonical" href="false"/>

  <meta name="viewport" content="width=device-width">
  <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"/>
  <link rel="apple-touch-icon" sizes="60x60" href="/images/apple-touch-icon-60x60.png"/>
  <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png"/>
  <link rel="apple-touch-icon" sizes="120x120" href="/images/apple-touch-icon-120x120.png"/>
  <link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png"/>
  <link rel="icon" sizes="36x36" href="/images/icon-36x36.png"/>
  <link rel="icon" sizes="48x48" href="/images/icon-48x48.png"/>
  <link rel="icon" sizes="72x72" href="/images/icon-72x72.png"/>
  <link rel="icon" sizes="96x96" href="/images/icon-96x96.png"/>
  <link rel="icon" sizes="128x128" href="/images/icon-128x128.png"/>
  <link rel="icon" sizes="144x144" href="/images/icon-144x144.png"/>
  <link rel="icon" sizes="192x192" href="/images/icon-192x192.png"/>

  <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"/>
  <link href="/stylesheets/dockericon.css" rel="stylesheet"/>
  <link href="/stylesheets/main.css" rel="stylesheet"/>
  <link href='//fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'/>

  <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
</head>
<body>
  <header class="pattern">
    <a href="/">
      <img class="img-responsive center-block"
          src="/images/logo.png"
          style="height: 80px; padding: 5px"/>
    </a>
  </header>
  <article class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-offset-1 col-sm-10 col-md-offset-2 col-md-8">
      <h1 id="dit4c-resbaz-2015-resbaz-">DIT4C &amp; <a href="http://resbaz.tumblr.com/conference">ResBaz 2015</a></h1>
<p>Running training sessions for 200 researchers requires a fair amount of grunt, and a high degree of redundancy to cope with failures.</p>
<p>Fortunately, DIT4C is designed to scale out.</p>
<h2 id="resources">Resources</h2>
<ul>
<li>5 platform nodes across 5 data-centres, including:<ul>
<li>5 routing nodes</li>
<li>3 portal nodes</li>
</ul>
</li>
<li>10-20 compute nodes</li>
</ul>
<p><img src="https://github.com/dit4c/dit4c/raw/master/docs/architecture.png" alt="DIT4C Architecture overview"></p>
<h2 id="clustering">Clustering</h2>
<p>A five node <a href="https://github.com/coreos/etcd">etcd</a> cluster is capable of tolerating two lost nodes before it ceases to function. Prior to deploying DIT4C, a cluster of CoreOS VMs was set up across five <a href="https://nectar.org.au/">NeCTAR Research Cloud</a> data-centres with &le;50ms ping times between them. <a href="https://github.com/coreos/flannel">Flannel</a> was deployed to provide a private shared network between the nodes.</p>
<figure>
<img src="https://maps.googleapis.com/maps/api/staticmap?size=400x350&format=png32&zoom=5&center=-37.814107,144.96327999999994&markers=-37.814107,144.96327999999994&markers=-34.92862119999999,138.5999594&markers=-35.2819998,149.12868430000003&markers=-42.8819032,147.32381480000004&markers=-33.8674869,151.20699020000006" class="img-rounded"/>
<figcaption>Data-centre locations</figcaption>
</figure>

<p>All five nodes were then deployed with routing containers, and three of the nodes with portal containers. A <a href="https://github.com/dit4c/dit4c-cluster-manager">cluster manager</a> was used to monitor the portal containers and setup continuous replication between the three CouchDB instances.</p>
<p>Round-robin DNS was used to spread requests between the five compute nodes. The <a href="https://github.com/hipache/hipache">Hipache</a> proxies spread requests between the three portal nodes.</p>
<h2 id="high-availability">High Availability</h2>
<p>For domains with multiple A records, modern web browsers can try another server if they fail to get a response. This allows nodes in the cluster to reboot with minimal disruption to users.</p>
<p>Monitoring of the <em>&quot;highcommand&quot;</em> portal servers is necessary to ensure Hipache doesn&#39;t continually try to contact dead servers.</p>
<p>For compute nodes, producing a HA solution was deamed too problematic, as multi-datacentre shared filesystems are not trivial deployments. Splitting compute nodes between multiple data-centres limits the damage from an outage instead.</p>

      </div>
    </div>
  </article>
  <footer class="jumbotron">
    <div class="container">
      <div class="row">
        <div class="col-xs-12 text-center">
          <p>Want to know more?</p>
          <p>
            <a href="https://github.com/dit4c/dit4c">
              DIT4C on GitHub
            </a>
          </p>
        </div>
      </div>
    </div>
  </footer>
</body>
</html>
